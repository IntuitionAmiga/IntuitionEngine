10 REM === ROTOZOOMER - PURE EHBASIC ===
20 REM Enable VideoChip 640x480
30 POKE &HF0000, 1: POKE &HF0004, 0
40 REM === GENERATE TEXTURE (256x256 checkerboard at 0x500000) ===
50 TB=&H500000: ST=1024
60 W=&HFFFFFFFF: B=&HFF000000
70 BLIT FILL TB, 128, 128, W, ST
80 BLIT FILL TB+512, 128, 128, B, ST
90 BLIT FILL TB+131072, 128, 128, B, ST
95 BLIT FILL TB+131584, 128, 128, W, ST
96 BB=&H600000
100 REM === MAIN LOOP ===
110 A=0: SI=0
200 REM === FRAME ===
210 SC=0.5+SIN(SI)*0.3: IF SC<0.2 THEN SC=0.2
220 CA=COS(A)/SC: SA=SIN(A)/SC
230 REM Block steps
240 BX=CA*8: BY=SA*8
250 EX=-SA*8: EY=CA*8
260 REM Starting U,V for top-left block centre
270 SU=128-40*BX-30*EX: SV=128-40*BY-30*EY
280 RU=SU: RV=SV
300 REM === RENDER 80x60 BLOCKS (8x8 pixels) TO BACK BUFFER ===
310 FOR Y=0 TO 59
320 U=RU: V=RV: P=BB+Y*20480
330 FOR X=0 TO 79
340 TU=INT(U) AND 255: TV=INT(V) AND 255
350 C=PEEK(TB+TV*1024+TU*4)
360 BLIT FILL P, 8, 8, C, 2560
370 P=P+32: U=U+BX: V=V+BY
380 NEXT X
390 RU=RU+EX: RV=RV+EY
400 NEXT Y
500 REM === FLIP AND ANIMATE ===
510 BLIT MEMCOPY &H600000, &H100000, 307200
520 A=A+0.3: IF A>6.28318 THEN A=A-6.28318
530 SI=SI+0.1
540 GOTO 200
